<!DOCTYPE html>
<html lang="en-GB">
  <head>
    <meta charset="utf-8" />
    <style>
      body {
        background: black;
        font-family: Arial, Helvetica, sans-serif;
      }
      html,
      body {
        width: 100%;
        height: 100%;
        margin: 0;
      }
    </style>
  </head>
  <body class="sl-theme-dark">
    <profiles-test style="height: 100%; display: flex"></profiles-test>

    <script type="module">
      import "@shoelace-style/shoelace/dist/themes/dark.css";

      import { AppAgentWebsocket } from "@holochain/client";
      import { LitElement, html } from "lit";
      import { ProfilesStore, ProfilesClient } from "../src/index.ts";

      import "../src/elements/profiles-context.ts";
      import "../src/elements/profile-prompt.ts";
      import "../src/elements/agent-avatar.ts";
      import "../src/elements/my-profile.ts";
      import "../src/elements/list-profiles.ts";
      import "../src/elements/search-agent.ts";
      // import "@holochain-open-dev/profiles/definitions/agent-avatar.js";
      // import "@holochain-open-dev/profiles/definitions/my-profile.js";
      // import "@holochain-open-dev/profiles/definitions/search-agent.js";
      // import "@holochain-open-dev/profiles/definitions/list-profiles.js";

      class ProfilesTest extends LitElement {
        static get properties() {
          return {
            loaded: {
              type: Boolean,
            },
          };
        }

        async firstUpdated() {
          const client = await AppAgentWebsocket.connect("", "test-app");

          const service = new ProfilesClient(client, "profiles-test");

          this.store = new ProfilesStore(service, {
            avatarMode: "avatar-required",
            additionalFields: [
              {
                name: "location",
                label: "Location",
                required: true,
              },
              {
                name: "bio",
                label: "Bio",
                required: false,
              },
            ],
          });
          this.loaded = true;
        }

        render() {
          if (!this.loaded) return html`<span>Loading...</span>`;
          return html`
            <profiles-context .store=${this.store}>
              <profile-prompt style="align-items: start">
                <list-profiles></list-profiles>
                <my-profile style="height: 800px; width: 800px;"></my-profile>
                <search-agent required include-myself></search-agent>
                <agent-avatar .agentPubKey=${this.store.client.client.myPubKey} showOnHover copyOnClick>
                  <div
                    style="background-color: lightgreen; width: 12px; height: 12px; border-radius: 50%"
                    slot="badge"
                  ></div>
                </agent-avatar>
                <agent-avatar .agentPubKey=${this.store.client.client.myPubKey}>
                </agent-avatar>
              </profile-prompt>
            </profiles-context>
          `;
        }
      }

      customElements.define("profiles-test", ProfilesTest);
    </script>
  </body>
</html>
